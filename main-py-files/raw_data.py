
import requests
import json
import csv
import wget
import pandas as pd
import numpy as np
import time 
from concurrent.futures import ThreadPoolExecutor
from geopy.geocoders import GoogleV3
from geopy.geocoders import Nominatim

# Define a list of URLs of the data source 
url_list = [
'https://s3.ap-southeast-1.amazonaws.com/table-downloads-ingest.data.gov.sg/d_ebc5ab87086db484f88045b47411ebc5.csv?AWSAccessKeyId=ASIAU7LWPY2WOGC4IN3B&Expires=1691935988&Signature=uaW%2FMxJg9dA3tsARTYdB3BkzyiA%3D&X-Amzn-Trace-Id=Root%3D1-64d8d6e4-4b63a05062ae8c3316ead33e%3BParent%3D03f3190403bc486d%3BSampled%3D1%3BLineage%3D00454cff%3A0&response-content-disposition=attachment%3B%20filename%3D%22ResaleFlatPricesBasedonApprovalDate19901999.csv%22&x-amz-security-token=IQoJb3JpZ2luX2VjEF0aDmFwLXNvdXRoZWFzdC0xIkgwRgIhAOKzmAD5wh2U3XCHHoIokQiKY%2FKZFBf3DvgwaYPUQu5aAiEAwDveRctRHXSVz1wVisBdMgaC8Ir%2FS1RQu1%2BuQmZJZfgqmgMIFhAEGgwzNDIyMzUyNjg3ODAiDCthSNH%2FOydbQvKw%2FCr3AovP9jdHYY%2F3o7c0RbtgyijA9Pt6DolzQ1MuMY71n1BW52fN3TkMUK2ulD1fj6G5pWbzrQ5WAn22L1iohK0qpHzypbEJKtNFh06l6z7Y2usGZsgp0Euo1PJlRFSprlopE7fnnm1MsqfNtY%2BmG1z8Eys%2BocYLlE3RqGjp1aKtXz1mjQh5PVCnHeqgswX3nSgNhkFcleWFu3Uhvn342rmgb%2F6iPEFIjh8iCTmA2MDVjcs1ESidvTQRe3%2BehNHNj3uIoW7A%2FX6l4t3Se1tL7X0aOWsibWw8Qd4d%2BJP1ZFMjwxfehbruH2Us4huNXqSPBJs2f1w8e2gNRepa8h%2FVTj0MyeWtULQ81D54RLjNMwm3K9D%2B1fTJZkub2NDhMS4TQ2NLwnoIE26Z367AeWXvdiRsPgKCoOCh3x1rLWkGWHTWCVryGqhDtdqNRaIzlnURe3ONV7AFMAiDL1iQWd7kzcQbClv9GBGd7ebTjUXY%2BwhS7%2BmOXAPk4Ub3nzDsqeOmBjqcAeHnS8Fa6lbkkFRZvhSEZjWFAPI8KzlDItUJ2%2BeO9j5vY89cJD4CL1eDmwJQ0QAQnzkeCpndseX0A1wSqRqNAI3FmwuZEXru3G%2FjwP2MkRhoermUsglFuaKvdyIjtQ%2BBVp1UfczFNDDl38p8pNkK%2BUimtwUEuvhPKZK5aPMEQN4ETdXm8%2B%2FvuMBSz3NZ2zmwo4FtWaolCUx%2FznrR8Q%3D%3D',
'https://s3.ap-southeast-1.amazonaws.com/table-downloads-ingest.data.gov.sg/d_43f493c6c50d54243cc1eab0df142d6a.csv?AWSAccessKeyId=ASIAU7LWPY2WP2RVRQUJ&Expires=1691935988&Signature=CJg5pwBextkAzEvxqHUkeGPPLOI%3D&X-Amzn-Trace-Id=Root%3D1-64d8d6e4-63d91c9659c5525568d1a5b5%3BParent%3D67664cc9958936d5%3BSampled%3D1%3BLineage%3D00454cff%3A0&response-content-disposition=attachment%3B%20filename%3D%22ResaleFlatPricesBasedonApprovalDate2000Feb2012.csv%22&x-amz-security-token=IQoJb3JpZ2luX2VjEF0aDmFwLXNvdXRoZWFzdC0xIkcwRQIhAKTSu3BdsHgXDxK0L7ZMXa5PDN4T0zn6VOI8nIZ1f6%2FTAiBa1uCEjEWimRgQYSO4bhH97Gx%2FUcHJmADfdBH4t4ee0iqaAwgWEAQaDDM0MjIzNTI2ODc4MCIMqILyIbz3EOMe6McfKvcCYzy%2FM0pKt%2FwgoVcvJeCG53dWBt8ewopbgs7K51ADJ8fFQcdMDy6asSNPLGoJmIrmIcJXx7P4F0ED99SKP%2BbL9NYoRMQZIl9Y%2BHGPhFWQFEe8%2B08huLtJsiqrJsyR4kyH7%2Fh9k3Q5k1w07oeNbbGleJUl1EjoHc0X%2Fvh4oXDiBu2TsqBzD2dIfX%2FPLhFhfgsTILNYBer4LZoFa8B6DMsBefPSZYtTKZ3sCfPAH4WVTDhmudExDTJa%2F3KYJSFq%2FcSxYHIRaPeEpc%2F4Q1WxckhtBpUfhzcSt30R4hccjd2%2BQs97W4wt01luz3J7WARc91szcKpq%2FVTLwkjCzGqdJoNktBjCQ9kOD1re8%2FDOsRLFFbRisknAFcSKkh0AmlHuZSv%2Fl0maHacTcYjNydmavNYW%2Ba%2B3dTFbwuhd4Gz0sNQ1xKOKJ2g9waJPQBnXtJdGGjaFeSNAl2T9O9y%2FjVEIygiBWg3HIdQSGsLaEfGQDGG7Kr2nRA9GIgWJMOyp46YGOp0B67KF%2F%2Bmu9%2BG5GiV9ypY%2B4ZK2Rj%2F9c1XhrtXUqBezGnUMozTmdxzUJCT5AAhOiRfN4ISt7ow3nget511thUZX5qbezaNi45UT9YqMiz0p8c1X72N00%2BntZ6rUWSOUvsXiKj4Ar47ri%2F1%2FcQNWZBYh7GJlA0k8BV1NSMiNVYz%2BQrQ6GSILiRjUZrSs8j19amnXXpJp7IyYYDO%2FLHFNDA%3D%3D',
'https://s3.ap-southeast-1.amazonaws.com/table-downloads-ingest.data.gov.sg/d_2d5ff9ea31397b66239f245f57751537.csv?AWSAccessKeyId=ASIAU7LWPY2WE7WV6TMG&Expires=1691935988&Signature=6cUVUG%2FeANJ6eXrHy20JZLgLfec%3D&X-Amzn-Trace-Id=Root%3D1-64d8d6e4-00eb83ca2cf0129156e26cd6%3BParent%3De8d5e0e1e8d93ea4%3BSampled%3D1%3BLineage%3D00454cff%3A0&response-content-disposition=attachment%3B%20filename%3D%22ResaleFlatPricesBasedonRegistrationDateFromMar2012toDec2014.csv%22&x-amz-security-token=IQoJb3JpZ2luX2VjEF0aDmFwLXNvdXRoZWFzdC0xIkgwRgIhAPPf5y4Y62TQYLp%2BJAbQeBR44z7wG9Ow09hwMKVEVOFPAiEA%2BRw%2FNCEodt9W%2BN42xeFSkjlYFyv8Z2nFXzBbaY2C5E4qmgMIFhAEGgwzNDIyMzUyNjg3ODAiDB6jIVP%2FidnciraMzir3AjUetqKs%2BlvEJmV9aFnI3hh9sHqEokaA7W6UpJ4N5kahnfR8%2Fk%2B70HnCGXb%2BIVBziiPxq6CeOjzO1m59rTRWgBMh1mthQiDOpxgRQf2QpBjiQOG9OXmANi0x%2B26o86QJk0GSGMNBJ17RqvVO%2FQrn4npG7VD4RIRXbkgMYO6DsEVnML7AqHK50pOTlVsKXTSZC8DqLrxVJPf5QtcZdC3%2F8luwq2hPM%2Bp5girH4tijtUAQazJ4HFESLEF4fotBiG9Iy9XaKr1XGthJVaFk9jQef3CqRCB0BjUb3%2FJdtYe8MphQlHsu26VxtDdbdr%2FyC%2BqQCUtArqjTp0HaPauyoiRpNPPNBBTAomoq2lmtDLD0zLuC5SxwiT7tTRON0oRPNNMeajgKifnJrdO0tTjJc3v%2BDqJVlncjbOSyZRpH%2BPAQYDtNB4U9Yf3bYFetYbiR%2FB%2BsUMLB%2FHQ1%2Bnc3Bw6X%2BPH%2FMrvx2Ffeg3NoqzRjU9S%2FZjU67R9yqeUIIzDrqeOmBjqcAbomlMxBGq7gPmLPjzrniYCapCl9e7F8XTvqT20cvilGLHxaujOfXdnkaB6pgU18xxKqcootvLhn0Bga3yF4yDK%2FlSbiwkyAyVxu87yJssX5tkOOiGGpdEENr1M0QLwBAhz%2FH7eJNK1O%2Bm2Fb%2F%2BTKzWdYEvqGxUI%2BADW4pqGfcFPzSslZLpJWzszDJvM8VRW8wrXld0MprpxcOYiOw%3D%3D',
'https://s3.ap-southeast-1.amazonaws.com/table-downloads-ingest.data.gov.sg/d_ea9ed51da2787afaf8e51f827c304208.csv?AWSAccessKeyId=ASIAU7LWPY2WKR6VSNKD&Expires=1691935988&Signature=KqUXLfv9YcUSqHy3sEPxy7bDDp0%3D&X-Amzn-Trace-Id=Root%3D1-64d8d6e4-706ad4bb6cc94d6e4bbc60d3%3BParent%3De17492aacc236592%3BSampled%3D1%3BLineage%3D00454cff%3A0&response-content-disposition=attachment%3B%20filename%3D%22ResaleFlatPricesBasedonRegistrationDateFromJan2015toDec2016.csv%22&x-amz-security-token=IQoJb3JpZ2luX2VjEF0aDmFwLXNvdXRoZWFzdC0xIkcwRQIgRifoI4SECdTVZiPmwGI%2FfUTYijvgrt8AcwYr3CkWpn8CIQDT9txzxe8pvG%2FSrgL3issY0pBC1QgmR4MwnJ%2BT%2B2wwKyqaAwgWEAQaDDM0MjIzNTI2ODc4MCIMH5wulokVW55tT8WLKvcCY3CovBKzc8Q4XvcnLhUIbYFsEveu09vruVEnASlSmQfb92g8enMkXYrAgnWV21V8Zf3g1FscYOdvrsTwyrzuZh5AUZ9pdHwNX3JpYcBj%2Fj3ptctFLNuCPGcX5skSlEVFWdn4BoqhHEG2ENm5R6qLqCJrn%2Bggp2WA7ogGJUDsk%2BxEeVaWijyupXvwyEEgZ0YwU6Mzetrlo%2BNajBXM4NX%2BY9gVgv5DmYGX4O4zDf%2FLdZfSL8LHvEkN6PZ9eUB6kgEDDiT1f2JGo%2FsRrByLVhvx%2BlwJ7QUGIYFrZNrNBqqXTKDlAYKCenppMF%2Fv%2Fzb6nDmztlTDJtwy3izDfCb6ISh0M0kD%2Fw2vZS4t2wJOI1jB8Yx3%2Fkr0tvSCNTC3rxhDxNpYifoA%2FULDqLpp12ZwDU1zIsRw1SZ4iNjFVU7lFOE3uBlG6R7zQe%2B%2FMC2mUPOJOiG%2FnAWzDSkxo0QUWpYPaJ9vQ%2FOGi0uoOl%2BloUWpz53IWxdAVs%2B6pfSxMOup46YGOp0BwFVV5aqn3h%2FN2KyLQzDBDuDUWe6JD1hd2%2FUkBqlYUXoSDHtzqk9AMLreMbczWtz3cfIMyFInKR854jcLUpWdRjSxbq%2BGmZxw1nUnMGshOaj2MdScDnqENXVqFHYA%2FKMeVvjcue3orchoFCgDL3MjPzhQ%2FwMSubyrpj97hMzlV5Fn8p8fmKf8ZuxFXkBfQ3yhL6JKmFIfHV0bsWk89Q%3D%3D',
'https://s3.ap-southeast-1.amazonaws.com/table-downloads-ingest.data.gov.sg/d_8b84c4ee58e3cfc0ece0d773c8ca6abc.csv?AWSAccessKeyId=ASIAU7LWPY2WNBBHS6KF&Expires=1691935988&Signature=%2Fw6pqwlyWnmuZVEJEAUvfmIcti0%3D&X-Amzn-Trace-Id=Root%3D1-64d8d6e4-367105461dacbe32553b54ed%3BParent%3D810137b237c631a1%3BSampled%3D1%3BLineage%3D00454cff%3A0&response-content-disposition=attachment%3B%20filename%3D%22ResaleflatpricesbasedonregistrationdatefromJan2017onwards.csv%22&x-amz-security-token=IQoJb3JpZ2luX2VjEF0aDmFwLXNvdXRoZWFzdC0xIkYwRAIgT6BIIs2ZSWBMEyoPLeCRNQhkmIpPZ72g4OFNvV8WQdwCIFhBbjDlSG9XA63xWtQnFaRvQkYEHvs8bLUsCC4YiSiTKpoDCBYQBBoMMzQyMjM1MjY4NzgwIgyClYptQJnmDe642QIq9wL5ic59YxjzDcQIcNulAtv7VyeNfU3aqIKk6P1YNFyno0ZQjdQB1CejZJ2LVumSAzFaD7n4NIqjOXFqk8Fb9V4ey6l74AHJtgtcWITa08m3Bsv%2B7wp0k51cyclLYlul%2BwwscpFiDvK9bXXDdOPc8BP1IA0rf9unYhrmGGDdJ7hzWtGkFxvaAmtp6VMb8%2FY%2BnmOQx0CL9yskjxndJu0%2BM0kyMsTk%2FHiuMxC9iolnc5RHFeU0NTsCOVfkWbiQIHUyORBP5GYPCQwxDtyxcC3MKRo4VFSadfQcMQJZxG4Au3ja0kNwX4YDAdFJjmghbWHQVPid7PEl5IA6P8jDk6kSworVQO1DrNbAvYd1J8fv%2BtyU2oiXMw%2FleKOmSo8KheB%2FpxFYt9QkDRZvZgSEbybr56kABvR9YuP8PjeoS7dlmpsdP9Y7MVjn4g9Rj6eN9eJKizIQM33MgdtH8z7jA3q0ps7%2BSncUFUtJmmhJGtvUluYE2tmUaemcehAw66njpgY6ngE0KVvSSS198koDwbUpg%2FdLNtfLBzRiR7J3W4mbMQF2FXR4dnWEqWQDHdD9n4Sey6QfOsSnNJTaw6E1fzN0xFVXLauyjdsTcBgY%2FqCgyXS91ggjUvN1bdQ81Gh%2BFcrpYDnpRx2YrHhXiJPRf98dImxxf6oQtLCrkSX25ckV7iyUTJnSMJrYINbi0Q1fKjESoJILIbLEUp%2B%2BtsNCqJQ3Cg%3D%3D'
]

# Downloads csv files with wget and save them in a list called files 
files = []
for url in url_list:
    filename = wget.download(url)
    files.append(filename)

# Create a DataFrame and concatenating all data files in the "files" list 
df_list = []
for f in files:
    df_small = pd.read_csv(f)
    df_list.append(df_small)
df = pd.concat(df_list, ignore_index=True)

# Export all raw data into a big CSV file named raw-data.csv 
df.to_csv("raw-data.csv")

